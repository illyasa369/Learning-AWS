# Containers in AWS

### Container-related Services on AWS
- Amazon ECS
- Amazon EKS
- AWS Fargate
- Amazon ECR
<br>

### Elastic Container Service (ECS)
- A service that runs Docker Containers on AWS.
- A running container in ECS is called an ECS task.
- ECS tasks are defined by task definitions.
- An ECS Cluster is a logical group of EC2 instances or Fargate resources used to run ECS tasks.
<br>

### ECS Launch Types
- When an ECS Cluster is created, a launch type must be chosen.

#### EC2 Launch Type
- User must provision and maintain the infrastructure (EC2 instances).
- Each EC2 instance must run the ECS agent to register it in the ECS Cluster.
- The ECS agent is a program that runs on the EC2 instance, allowing ECS to manage the container.
- AWS handles starting and stopping containers.


#### Fargate Launch Type
- Serverless: AWS manages all infrastructure (EC2 instances).
- User is required to create task definitions.
- AWS runs ECS tasks using the task definitions.
- Scaling is done by increasing/decreasing the number of running ECS tasks.
<br>

### IAM Roles for ECS
- ECS uses two main IAM Roles.

#### EC2 Instance Profile
- Used only with EC2 Launch Type
- Attached to the EC2 instance.
- Used by the ECS agent, not the container.
- Allows the ECS agent to communicate with AWS Services.
  - Register EC2 instances with EC2.
  - Send container logs to CloudWatch.
  - Pull container images from ECR.

#### ECS Task Role
- Defined in the task definition.
- Works with EC2 and Fargate launch types.
- Attached to the ECS Task.
- Allows the application in the container to access AWS services.
  - Task A can access S3.
  - Task B can access DynamoDB.
- Different roles should be applied to the different tasks running.
<br>

### ECS - Load Balancer Integrations
- CLB: Supported but not recommended (limited features, does not support Fargate).
- ALB: Supported and ideal for most ECS use cases.
- NLB: Only recommended for high-performance use cases or pairing with AWS Private Link.
<br>
